function __buildTree(data,options){var tmpl='    <ul>        <% _.each(context, function(parent, index) { %>        <li class="section">            <span class="menu-1"><%= parent.key %><i class="glyphicon glyphicon-chevron-up"></i></span>            <% if (options.startCollapsed) { %>            <ul style="display: none;">            <% } else { %>            <ul>            <% } %>                <% _.each(parent.values, function(child, index) { %>                <% if (options.cPage == child.href) { %>                    <li class="page curr" id="<%= child.href %>">                    <i class="glyphicon glyphicon-log-out"></i><%= child.key %>                <% } else { %>                    <li class="page" id="<%= child.href %>">                    <i class="glyphicon glyphicon-edit"></i><%= child.key %>                <% } %>                </li>                <% }); %>            </ul>        </li>        <% }); %>    </ul>';return _.template(tmpl,{context:data,options:options})}function __toggleIcon(node){if(node.find("span.menu-1 i.glyphicon-chevron-up").length!=0){node.children("span").children("i").removeClass("glyphicon-chevron-up").addClass("glyphicon-chevron-down")}else{node.children("span").children("i").removeClass("glyphicon-chevron-down").addClass("glyphicon-chevron-up")}}function __expandAll(){_.each($("#listTree li.section"),function(e){var node=$(e);__toggleIcon(node);node.children("ul").children("li").slideDown("fast")})}function __collapseAll(){_.each($("#listTree li.section"),function(e){var node=$(e);__toggleIcon(node);node.children("ul").children("li").slideUp("fast")})}function __toggleMenu(e){var node=$(e.target).parentsUntil("ul");__toggleIcon(node);node.children("ul").children("li").slideToggle(200);e.stopImmediatePropagation()}function __toggleCurrent(node){if(node){$("#listTree li.page").removeClass("curr");$("#listTree li.page i").removeClass("glyphicon-log-out").addClass("glyphicon-edit");node.addClass("curr");node.children("i").addClass("glyphicon-log-out")}else{console.log("toggle-current-error")}}function __getAbsolutePath(){return new RegExp("[^?]+/").exec(window.location.href)}function __getDoc(node,haku){__toggleCurrent(node);$.get(haku).done(function(data){$("#page").html(marked(data));$.cookie("currPage",haku,{expires:180})}).fail(function(){console.log("sivu puuttuu")})}function __getLink(e){var haku=e.target.href||"sivu-puuttuu.md",ap=new RegExp(__getAbsolutePath()),node="";if(haku.search(ap)>=0){e.preventDefault();haku=haku.replace(ap,"");_.each($("#listTree li.page"),function(lp){if(lp.id===haku){node=$(lp)}});__getDoc(node,haku)}else{e.target.target="_blank"}}